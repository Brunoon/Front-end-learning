---
layout: default
title: {{ site.name }}
---
## 动态CDN加速
动态内容的响应时间：ESI和AMP HTML这样的技术。
AMP其实就是限制了页面的资源加载，限制了可以使用的元素，将耗时的元素取消，将耗资源的元素通过custom elements自己来管理资源加载。避免资源默认被加载，只能使用行内元素

动态CDN优化：
1.从源服务器优化动态内容的交付
2.使数据从源服务器绕过标准网络节点和被交付通过一个更加直接和有效的途径，减少加载时间和提高响应时间
3.缓存和交付动态页面组件，可以跨多个用户会话使用

动态内容的定义是完全动态，对象不会两次相同，每次都得去起源处

事件驱动的内容，实际上是静态的，只是时间不可预期，没法提前决定他的生命周期。

因为这部分内容很难被缓存，所以CDN把它定义为动态的。实际上只要有个好的缓存机制，是可以被缓存的

大多数CDN对两者是同样的处理的。为什么呢：
     1. 缺少好的失效框架，除了那几个头部之外，没办法让他失效。所以加上事件驱动内容的不可预见性，就直接取消缓存了
     2.另一个问题是对于如果做cdn缓存事件驱动内容，对于页面的访问情况得不到一个好的反馈，大多数分析和统计都是做在源服务器上的，如果达不到，很多都做不了。

大多数CDN把事件驱动当做动态的。然后关注在加快源服务器到目标的速度。比如Dynamic Site Acceleration (DSA)。使用一些TCP优化，减轻网络开销来更快的内容交付。也就是不对称的配送路径优化。

一些CDN提供了额外的服务来研究对称的优化。就是在用户侧有一层CDN，服务器侧也有一层CDN。

当然，事件驱动并不一定总是被回源的，我们也可以用cache-control的header。可能会比较短的cache，比如几分钟。

有些站点采用Edge Side Includes (ESI),下面会细讲

缓存客户驱动事件是很好的，访问时间肯定比回源快。也节省了服务器资源。

Fastly提供了即时清洗以及实时的打点

动态内容:通过网络和协议优化，快速起源机制。

更优的DNS map来加速网络层传输的块。

更好的TCP算法来处理堵塞，而不是丢失。

复用在边缘服务器和原始服务器包括边缘服务器之间的HTTP连接。

会在数据离开源服务器之后就立刻进行压缩来缩小传输中的代码块，以及到用户的代码大小。

从动态内容中识别缓存内容。

### ESI(Edge Side Includes)
来把HTML切成碎片，每一片可以有自己的独立的缓存策略。CDN将缓存的静态部分模板和回到起源的非静态内容，在CDN上进行组装，然后全部交付给客户机。ESI很有效，但是比较难实现，在HTML页面也需要不少额外的代码

就是将大家能看到的一样的东西与用户行为相关的分离，提高首屏加载。但是在逻辑层需要去判断是否登录。看上去我们把这个功能用ajax来做也行，但是当js没法运行的时候，ESI还是可以这么做。
