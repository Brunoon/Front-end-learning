---
layout: default
title: {{ site.name }}
---
# 6章HTTP首部
HTTP协议的请求和响应报文中必定包含HTTP首部。

HTTP请求报文是由方法，URI，HTTP版本和首部字段

HTTP响应是由HTTP版本，状态码和首部字段组成

## 首部内容
首部字段给浏览器和服务器提供报文主体大小，使用的语言，认证信息等内容。

一般就是首部字段名:字段值。

注意字段值可以有多个值，由逗号分隔。

若是重复了话规范没有明确，得看浏览器内部处理逻辑的不同。

分为4种类型：

 - 通用首部字段：请求和响应报文都会使用的首部，9个
 - 请求首部字段：请求使用的首部，补充了请求的增加内容，客户端信息，响应内容优先级等信息
 - 响应首部字段：补充了响应的附加内容，也会要求客户端附加额外的内容信息
 - 实体首部字段：针对实体部分使用的首部，补充了资源内容的更新时间

HTTP1.1定义了47种首部字段。先不直接列举了。

注意，除了规范中的这些个首部字段，还有定义在其他RFC的首部字段，比如Cookie，Set-Cookie等使用频率也很高。

HTTP首部将定义成缓存代理和非缓存代理的行为，分成了2种。

 - 端到端首部：此类别的首部会发送到最终的接收目标，且必须保存在缓存生成的响应中，必须被转发。
 - 逐跳首部：只对单次转发有效，会因为缓存和代理而不再转发。如果要使用hop-by-hop首部，需要提供Connection首部。有8个

## 通用首部字段

 - Cache-control：操作缓存的工作机制。比如max-age是几秒内不会重新请求服务器，s-maxage是对多位用户使用的公共缓存服务器；no-cache是不缓存过期的，就是说缓存服务器还是会缓存，只是每次都会从服务器确认下。no-store才是不能存储；public指可以向任意用户提供缓冲，而private则是特定用户；min-fresh要求缓存服务器返回至少还未过指定时间的缓存资源；max-stale如果不设置值的话，那么多了多久都照常接收，如果设置了值，那么哪怕过期，只要在值的时间范围内，就接收；only-if-cached这个要求只有缓存服务器本地有缓存的时候才会要求返回，否则返回状态码504；must-revalidate要求代理向源服务器验证时间，会忽略max-stale；no-transform规定在请求还是响应中，缓存不能改变主题的媒体类型，可以防止压缩图片等类似操作；他还可以扩展字段，比如community，不过这些个扩展只对能理解他的缓存服务器来说才是有意义的。
 - Connection：控制不再转发给代理的字段；管理持久化连接。就是说他能通知代理把一些头部删掉然后发给服务器。然后为了旧版本的HTTP也持久化连接，设置Connection:keep-alive，当想断开连接的时候，就返回close就好了。
 - Date：表示创建报文的日期和时间。
 - Pragma：no-cache这个字段主要是历史遗留字段，和Cache-Control：no-cache一样。为了兼容HTTP1.0.
 - Trailer：这个字段告诉服务器在报文的后面还会出现的首部字段，用在分块传输的时候
 - Transfer-Encoding：这个字段规定了传输报文主体采用的编码方式，只在分块传输编码的时候有效
 - Upgrade：这个字段用来检测是否可以使用更高版本的协议进行通信。他只能作用于邻近的服务器，而且要连着Connection字段使用。
 - 
