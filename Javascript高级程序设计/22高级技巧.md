# 22高级技巧
## 高级函数
### 安全的类型检测
typeof并不能够满足，有时对正则typeof也会返回function。

instanceof在页面上存在多个全局作用域的时候也是问题多多，比如多个frame，他们就不行了。

JSON对象也有这个问题。

解决方法很单一：

Object.prototype.toString.call(obj)就行了。

- 数组的就是[object array]
- 函数的就是[object function]
- 正则表达式就是[object RegExp]

如果不是原生的话，任何构造函数都会是[object Object]

### 作用域安全的构造函数

```javascript
function Person(name,job){
  this.name = name;
  this.job = job;
}
```

这个方法new的话不会有问题，但是如果直接调用的话，里面的this就会变成window，所以安全的写法应该是进行一次判定。

```javascript
function Person(name,job){
  if(this instanceof Person){
    this.name = name;
    this.job = job;
  }else{
    return new Person(name,job);
  }
}
```
